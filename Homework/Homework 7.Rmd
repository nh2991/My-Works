---
output:
  pdf_document: default
  html_document: default
---

---
title: \textbf{Homework 7}
author: "Juwon Lee, Economics and Statistics, UCLA"
date: "2023-05-15"
output: 
  pdf_document:
    latex_engine: xelatex
---

tinytex::install_tinytex()

### Exercise 1.

#### a.

\noindent Buy 1 put, and buy 1 stock.  
Let the price of put $p$, the stock price $S_0$ and $S_1$, exercise price $E$.  

Then, (1) if $S_1 \uparrow$, then $-p + (S_1 - S_0)$,  
(2) if $S_1 \downarrow$, then $-p + (E - S_1) + (S_1 - S_0) = -p +E - S_0$.  

```{r}

x7_hw7 <- seq(30, 50)
y7_hw7 <- rep(-5, length(x7_hw7))

x8_hw7 <- seq(50, 70)
y8_hw7 <- -55 + x8_hw7

plot(c(x7_hw7, x8_hw7), c(y7_hw7, y8_hw7), type='l', xlim=c(45, 60), ylim=c(-10, 5), xlab='Stock Price at Period 1', ylab='Profit', main='Buy 1 put + Buy 1 Stock (Example)')
abline(v=50, lty='dashed') ; abline(h=-5, lty='dashed')
points(50,-5, pch=16) ; text(52,-6, '(50, -5)')

```

\newpage

\noindent Suppose you sell 1 call option and sell 1 stock.  
Then (1) if $S_1 \uparrow$, then $- c + (S_1 - S_0)$.  
(2) if $S_1 \downarrow$, then $-c + (E - S_1) + (S_1 - S_0) = -c + E - S_0$.  

\noindent It is equivalent to protective put, if put-call parity holds.  

#### b.

\noindent We don't know the price of call options $c_1, c_2, c_3$,  
but we take long position of two call options at each of $50$ and $60$,  
and take take one short position of call option at $55$.  

### Exercise 2.

#### a.

\noindent $S_0 = 110, c = 17, p=5, r=0.05, E=105, t=1$.  
put-call parity is $p + S_0 = c + E e^{-rt}$, so that  
$5 + 110 \neq 17 + 105 * e^{-0.05} = 17 + 99.87909 = 116.87909$.  
Thus, call option is overpriced.

\noindent If we take short call, long put, and long the stock, then  
(1) $S < 105$: $17 + (-5) + (105 - S) + (S - 110) = 7$.  
(2) $S > 105$: $17 + (-5) + (S - 110) = S - 98 > 7$.  
Thus, there can be riskless profit.  

#### b.  

\noindent $p_A = 4, S_0 = 46, E = 51, t = 1, r= 0.005$.  
Lower bound of put is $p \geq Ee^{-rt} - S_0$, so that  
$4 \ngeq 51 * e^{-0.005} -46 = 4.745636$. Thus, it doesn't hold.  

\noindent In this situation, if we lend 50\$ and buy 1 put and 1 stock.  
(1) $S_1 < 51$: $S_1 + (51 - S_1) - 50 * 1.005 = 0.75$.  
(2) $S_1 > 51$: $S_1 - 50 * 1.005 = S_1 - 50.25 > 0.75$.  
Thus, there can be riskless profit.  

### Exercise 3.

\noindent Sell call option at $c = 4, S_0 = 47, E = 50$.  
(1) $S_1 < 50$: $4$.  
(2) $S_1 > 50$: $4 + (50 - S_1) = 54 - S_1$.  

```{r}

x_hw7 <- seq(30, 50)
y_hw7 <- rep(4,21)

x2_hw7 <- seq(50, 70)
y2_hw7 <- 54 - x2_hw7

plot(c(x_hw7,x2_hw7), c(y_hw7,y2_hw7), type='l', xlim=c(40, 60), ylim=c(-6, 10), xlab='Stock Price at Period 1', ylab='Profit', main='Sell 1 call')
abline(v=54, lty='dashed')
abline(h=0, lty='dashed')
points(54, 0, pch=16)
text(56, 1, '(54, 0)')

```

### Exercise 4

\noindent Buy 1 put option at $p=3, S_0 = 42, E = 40$.  
(1) $S_1 < 40$: $(-3) + (40 - S_1) = 37 - S_1$.  
(2) $S_1 > 40$: $-3$.  

```{r}

x3_hw7 <- seq(20, 40)
y3_hw7 <- 37 - x3_hw7

x4_hw7 <- seq(40, 60)
y4_hw7 <- rep(-3, length(x4_hw7))

plot(c(x3_hw7, x4_hw7), c(y3_hw7, y4_hw7), type='l', xlim=c(30, 50), ylim=c(-6,6), xlab='Stock Price at Period 1', ylab='Profit', main='Buy 1 put')
abline(v=37, lty='dashed')
abline(h=0, lty='dashed')
points(37,0,pch=16)
text(39,1, '(37,0)')

```

### Exercise 5

\noindent Buy 2 put at $6 * 2 = 12$, 1 call at $5$. Let $E = 50$.  

#### a.

\noindent (1) $S<50$: $-12 + 2 * (50 - S) = 88 - 2S$.  
(2) $S>50$: $-12$.  

#### b.

\noindent (1) $S<50$: $-5$.  
(2) $S>50$: $-5 + (S - 50) = -55 + S$.  

```{r}

x6_hw7 <- seq(50, 70)
y6_hw7 <- rep(-12, length(x6_hw7))

x5_hw7 <- seq(30, 50)
y5_hw7 <- 88 - 2 * x5_hw7

plot(c(x5_hw7, x6_hw7), c(y5_hw7, y6_hw7), type='l', xlim=c(45, 60), ylim=c(-20, 7), xlab='Stock Price at Period 1', ylab='Profit', main='Buy 2 puts')
abline(v=50, lty='dashed')
abline(h=-12, lty='dashed')
points(50,-12,pch=16)
text(52,-10, '(50, -12)')

x7_hw7 <- seq(30, 50)
y7_hw7 <- rep(-5, length(x7_hw7))

x8_hw7 <- seq(50, 70)
y8_hw7 <- -55 + x8_hw7

plot(c(x7_hw7, x8_hw7), c(y7_hw7, y8_hw7), type='l', xlim=c(45, 60), ylim=c(-10, 5), xlab='Stock Price at Period 1', ylab='Profit', main='Buy 1 call')
abline(v=50, lty='dashed')
abline(h=-5, lty='dashed')
points(50,-5, pch=16)
text(52,-6, '(50, -5)')

plot(c(x7_hw7, x8_hw7), c(y7_hw7, y8_hw7), type='l', xlim=c(40, 70), ylim=c(-20, 20), xlab='Stock Price at Period 1', ylab='Profit', main='Buy (1 call + 2 puts)')
lines(c(x5_hw7, x6_hw7), c(y5_hw7, y6_hw7))
lines(c(x5_hw7, x6_hw7), c(y5_hw7 + y7_hw7, y6_hw7 + y8_hw7), col='red')
points(50, -5, pch=16)
points(50, -12, pch=16)
points(50, -17, pch=16, col='red')
abline(h=0, lty='dashed')
points(67, 0, pch=16, col='red')
text(54, -18, '(50, -17)', col='red')
text(64, 2, '(67, 0)', col='red')

```

### Exercise 6.

\noindent Sell two calls at $E_a =45, C_a=5$, buy one call at $E_b = 40, C_b=8$.  

\noindent a.  
(1) $S < 45$: $10$.  
(2) $S > 45$: $10 + 2 * (45 - S) = 100 -2S$.  

\noindent b.  
(1) $S < 40$: $-8$.  
(2) $S > 40$: $-8 + (S - 40) = S - 48$.  

\noindent a + b.  
(1) $S < 40$: $2$.  
(2) $40 < S < 45$: $S - 48 + 10 = S - 38$.  
(3) $S > 45$: $52-S$.

```{r}

x9_hw7 <- seq(20, 40)
y9_hw7 <- rep(2, length(x9_hw7))

x10_hw7 <- seq(40, 45)
y10_hw7 <- x10_hw7 - 38

x11_hw7 <- seq(45, 60)
y11_hw7 <- 52 - x11_hw7

x12_hw7 <- seq(20, 45)
y12_hw7 <- rep(10, length(x12_hw7))

x13_hw7 <- seq(45, 60)
y13_hw7 <- 100 - 2 * x13_hw7

x14_hw7 <- seq(20, 40)
y14_hw7 <- rep(-8, length(x14_hw7))

x15_hw7 <- seq(40, 60)
y15_hw7 <- x15_hw7 - 48

plot(c(x9_hw7, x10_hw7, x11_hw7), c(y9_hw7, y10_hw7, y11_hw7), type='l', col='red', xlim=c(35, 57), ylim=c(-10,10),
     xlab='Stock Price at Period 1', ylab='Profit', main='Buy 1 call + Sell 2 calls')
lines(x12_hw7, y12_hw7)
lines(x13_hw7, y13_hw7)
lines(x14_hw7, y14_hw7)
lines(x15_hw7, y15_hw7)
abline(h=0, lty='dashed')
points(40, 2, pch=16, col='red')
points(45, 7, pch=16, col='red')
points(52, 0, pch=16, col='red')
text(38, 3, '(40, 2)', col='red')
text(43, 8, '(45, 7)', col='red')
text(54, 1, '(52, 0)', col='red')

```

\newpage

### Exercise 7.

\noindent $p + S_0 = c + Ee^{-rt}$.  

#### a. Long put, long stock.  

\noindent (1) $S_1 < E$: $-p + (E - S_1) + (S_1 - S_0) = -p + E - S_0$.  
(2) $S_1 > E$: $-p + (S_1 - S_0)$.  

```{r}

plot(c(x7_hw7, x8_hw7), c(y7_hw7, y8_hw7), type='l', xlim=c(45, 60), ylim=c(-10, 5), xlab='Stock Price at Period 1', ylab='Profit', main='Long put + Long Stock')
abline(v=55, lty='dashed')
abline(h=0, lty='dashed')
points(55,0, pch=16)
text(53,1, '(S + p, 0)')

```

#### b. Short put, short stock.  

\noindent (1) $S_1 < E$: $p + (S_1 - E) + (S_0 - S_1) = p + S_0 - E$.  
(2) $S_1 > E$: $p + (S_0 - S_1)$.  

```{r}

plot(c(x_hw7,x2_hw7), c(y_hw7,y2_hw7), type='l', xlim=c(40, 60), ylim=c(-6, 10), xlab='Stock Price at Period 1', ylab='Profit', main='Short put + Short stock')
abline(v=54, lty='dashed')
abline(h=0, lty='dashed')
points(54, 0, pch=16)
text(57, 1, '(p + S, 0)')

```

#### c. Long call, short stock.  

\noindent (1) $S_1 < E$: $-c + (S_0 - S_1)$.  
(2) $S_1 > E$: $-c + (S_1 - E) + (S_0 - S_1) = -c + S_0 - E$.  

```{r}

plot(c(x_hw7,x2_hw7), c(y_hw7 - 8,y2_hw7 - 8), type='l', xlim=c(40, 60), ylim=c(-6, 2), xlab='Stock Price at Period 1', ylab='Profit', main='Long call + Short stock')
abline(v=50, lty='dashed') ; abline(h=0, lty='dashed') ; points(50, -4, pch=16) ; text(54, -3.5, '(E, - c + S - E)')

```

#### d. Short call, long stock.  

\noindent (1) $S_1 < E$: $-c + (S_1 - S_0)$.  
(2) $S_1 > E$: $-c + (E - S_1) + (S_1 - S_0) = -c + E - S_0$.  

```{r}

plot(c(x7_hw7, x8_hw7), c(y7_hw7, y8_hw7), type='l', xlim=c(45, 60), ylim=c(-10, 5), xlab='Stock Price at Period 1', ylab='Profit', main='Short call + Long Stock')
abline(v=55, lty='dashed')
abline(h=0, lty='dashed')
points(55,0, pch=16)
text(53,1, '(c + S, 0)')

```

### Exercise 8.

#### a. Bull call spread

\noindent Buy one call at $c_1, E=50$, sell one call at $c_2, E=60$.  
Larger the exercise price, then cheaper option price, because it is the right to buy more expensive option.  
Thus, suppose $c_1 > c_2$.

\noindent (1) $S_1 < 50$: $-c_1 + c_2$.  
(2) $50 < S_1 < 60$: $-c_1 + (S_1 - 50) + c_2$.  
(3) $S_1 > 60$: $-c_1 + (S_2 -50) + c_2 + (60 - S_2) = (c_2 - c_1) + 10$.  

```{r}

x16_hw7 <- seq(-10, 50)
y16_hw7 <- rep(-5, length(x16_hw7))

x17_hw7 <- seq(50, 60)
y17_hw7 <-  -5 - 50 + x17_hw7

x18_hw7 <- seq(60, 90)
y18_hw7 <- rep(5, length(x18_hw7))

plot(c(x16_hw7, x17_hw7, x18_hw7), c(y16_hw7, y17_hw7, y18_hw7), type='l', xlim=c(40, 70), ylim=c(-8, 8), 
     xlab='Stock Price at Period 1', ylab= 'Profit', main='Bull call spread')
abline(v=50, lty='dashed')
abline(v=60, lty='dashed')
points(50,-5, pch=16)
points(60, 5, pch=16)
text(46, -4, 'C2 - C1')
text(65, 4, 'C2 - C1 + 10')

```

#### b. Bear put spread 

\noindent Buy one put at $p_1, E=60$, sell one put at $p_2, E=50$.  
Larger the exercise price, more expensive the option price, because it is the right to sell at that level of price.  
Thus, suppose $p_1 > p_2$.  

\noindent (1) $S_1 < 50$: $-p_1 + (60 - S_1) + p_2 + (S_1 - 50) = 10 + (p_2 - p_1)$.  
(2) $50 < S_1 < 60$: $-p_1 + (60 - S_1) + p_2$.  
(3) $S_1 > 60$: $-p_1 + p_2$.  

```{r}

plot(c(x16_hw7, x17_hw7, x18_hw7), c(y16_hw7 + 10, (-1) * y17_hw7, y18_hw7 - 10), type='l', xlim=c(40, 70), ylim=c(-8,8),
     xlab='Stock Price at Period 1', ylab= 'Profit', main='Bear put spread')
abline(v=50, lty='dashed')
abline(v=60, lty='dashed')
points(50, 5, pch=16)
points(60, -5, pch=16)
text(45, 4, '10 + P2 - P1')
text(64, -4, 'P2 - P1')

```

#### c. Bull call spread + Bear put spread 

\noindent

```{r}

plot(c(x16_hw7, x17_hw7, x18_hw7), c(y16_hw7 + y16_hw7 + 10, y17_hw7 + (-1) * y17_hw7, y18_hw7 + y18_hw7 - 10), type='l', xlim=c(40, 70), ylim=c(-8,8),
     xlab='Stock Price at Period 1', ylab= 'Profit', main='Bull call Spread + Bear put spread', col='red')
lines(c(x16_hw7, x17_hw7, x18_hw7), c(y16_hw7, y17_hw7, y18_hw7), type='l') ; lines(c(x16_hw7, x17_hw7, x18_hw7), c(y16_hw7 + 10, (-1) * y17_hw7, y18_hw7 - 10), type='l') ; text(64, 4, 'Bull call') ; text(64, -4, 'Bear put')

```

\newpage

### Exercise 9.  

\noindent Sell put option at $p_2, E_1 = 50$, buy one put option at $p_1, E_2 = 60$, then $E_2 > E_1$.  
This is same with the case of Exercise 8. a. Bear put spread,  
if we take $p_2 - p_1 = 5$. QED  

### Exercise 10. 

\noindent Sell one call at $c_1 , E_1 = 50$, buy one call at $c_2 , E_2 =60$.  
Suppose $c_1 > c_2$.  

\noindent (1) $S_1 < 50$: $c_1 - c_2$.  
(2) $50 < S_1 < 60$: $c_1 + (50 - S_1) - c_2$.  
(3) $S_1 > 60$: $c_1 + (50 - S_1 ) - c_2 + (S_1 - 60) = c_1 - c_2 - 10$.  

```{r}

plot(c(x16_hw7, x17_hw7, x18_hw7), c(y16_hw7 + 10, (-1) * y17_hw7, y18_hw7 - 10), type='l', xlim=c(40, 70), ylim=c(-8,8),
     xlab='Stock Price at Period 1', ylab= 'Profit', main='Sell one call + Buy one call')
abline(v=50, lty='dashed')
abline(v=60, lty='dashed')
points(50, 5, pch=16)
points(60, -5, pch=16)
text(46, 4, 'C1 - C2')
text(65, -4, 'C1 - C2 - 10')

```